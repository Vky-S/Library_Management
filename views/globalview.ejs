<%- include("partials/header") -%>

  <div class="sidepane">
    <div class="logo flex-item">
      <img class="logo-img" src="/images/books_icon.png" alt="Books_Logo"><p class="logo-heading">LMS</p>
    </div>
    <div class="flex-item">
    <a href="/home" class="home selected"><i class="fas fa-home fa-sm icon"></i>Home</a>
    </div>
    <hr>
    <div class="flex-item">
      <a href="javascript:void(0)" onclick="showSubMenu(event)" data-value="books" class="books"><i data-value="books" class="fas fa-book fa-sm icon"></i>Books<i data-value="books" class="fas fa-sort-down fa-sm down-icon"></i></a>
      <ul class="active">
        <li><a href="/all_books">All Books</a></li>
        <li><a href="/my_books">My Books</a></li>
      </ul>
    </div>
    <hr>
    <div class="flex-item">
      <a href="javascript:void(0)" onclick="showSubMenu(event)" data-value="request-book" class="request-book"><i data-value="request-book" class="fa fa-hand-o-up fa-sm icon" aria-hidden="true"></i>Requests<i data-value="request-book" class="fas fa-sort-down fa-sm down-icon"></i></a>
      <ul class="active">
        <li><a href="/request_a_book">Request a Book</a></li>
        <li><a href="/view_requests">View Requests</a></li>
      </ul>
    </div>
  <hr>
  <div class="flex-item">
    <a href="/user_profile" class="user-info"><i class="fas fa-user-circle fa-sm icon"></i>My Info</a>
  </div>
  <hr>
  </div>
  <div class="copyright">
    &copy; 2020
  </div>
  <div class="log-out" onclick="location.href = '/logout'">
    <a class="log-out-text" href="/logout"><i class="fas fa-sign-out-alt icon-lg"></i>Logout</a>
  </div>
  <a href="/guide/others#home-guide" target="_blank" class="help"><i class="fas fa-question fa-lg"></i></a>


    <hr class="hr-rule">
  <div class="dashboard">
    <div onclick="location.href='/my_books'" class="new-arrivals">
      <p class="heading-text">New Arrivals</p>
      <table>
        <tr>
          <th>Book Name</th>
          <th>Author Name</th>
          <th>Price</th>
        </tr>
        <%  home.allBooks.reverse().forEach((book, i) => { %>
           <% if(i < 7) { %>
             <tr>
               <td><%= book.book_name %></td>
               <td><%= book.author_name %></td>
               <td><%= book.price %></td>
             </tr>
         <%  } %>
         <% }); %>
      </table>
    </div>
    <div onclick="location.href='/view_requests'" class="view-requests">
      <p class="heading-text">View Requests</p>
      <table>
        <tr>
          <th>Book Name</th>
          <th>Author Name</th>
          <th>Request Status</th>
        </tr>
        <% home.myRequests.forEach((request, i) => { %>
          <% if(i < 7){ %>
            <tr>
              <td><%= request.book_name %></td>
              <td><%= request.author_name %></td>
              <td><%= request.request_status %></td>
            </tr>
          <% } %>
        <% }); %>
      </table>
    </div>
    <div onclick="location.href='/my_books'" class="my-books">
      <p class="heading-text">My Books</p>
      <table>
        <tr>
          <th>Book Name</th>
          <th>Author Name</th>
          <th>Price</th>
          <th>Issued Date</th>
          <th>Return Date</th>
        </tr>
        <% home.myBooks.forEach((book, i) => { %>
          <% if(i < 5){ %>
            <% const issuedDate = book.issued_date.getDate() + "/" + (book.issued_date.getMonth() + 1) + "/" + book.issued_date.getFullYear() %>
            <% const returnDate = book.return_date.getDate() + "/" + (book.return_date.getMonth() + 1) + "/" + book.return_date.getFullYear() %>
            <tr>
              <td><%= book.book_name %></td>
              <td><%= book.author_name %></td>
              <td><%= book.price %></td>
              <td><%= issuedDate %></td>
              <td><%= returnDate %></td>
            </tr>
        <%  } %>
        <% }); %>
      </table>
    </div>
    <div onclick="location.href='/all_books'" class="all-books">
      <p class="heading-text">All Books</p>
      <table>
        <tr>
          <th>Book Name</th>
          <th>Author Name</th>
          <th>Price</th>
        </tr>
       <%  home.allBooks.forEach((book, i) => { %>
          <% if(i < 7) { %>
            <tr>
              <td><%= book.book_name %></td>
              <td><%= book.author_name %></td>
              <td><%= book.price %></td>
            </tr>
        <%  } %>
        <% }); %>
      </table>
    </div>
  </div>
  <div class="hr-1">
  </div>
  <div class="hr-2">
  </div>
  <div class="hr-3">
  </div>
  <div class="hr-4">
  </div>


<%- include("partials/footer") -%>
